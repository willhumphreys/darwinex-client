{
  "//": {
    "metadata": {
      "backend": "local",
      "stackName": "trading-assistant-stateless",
      "version": "0.19.2"
    },
    "outputs": {
    }
  },
  "provider": {
    "kubernetes": [
      {
        "host": "https://192.168.1.202:6443",
        "ignore_annotations": [
          "metallb\\.universe\\.tf/ip-allocated-from-pool"
        ],
        "insecure": true,
        "token": ""
      }
    ]
  },
  "resource": {
    "kubernetes_deployment": {
      "mysql": {
        "//": {
          "metadata": {
            "path": "trading-assistant-stateless/mysql",
            "uniqueId": "mysql"
          }
        },
        "metadata": {
          "labels": {
            "app": "mysql"
          },
          "name": "mysql-container",
          "namespace": "trading-assistant"
        },
        "spec": {
          "replicas": "1",
          "selector": {
            "match_labels": {
              "app": "mysql"
            }
          },
          "template": {
            "metadata": {
              "labels": {
                "app": "mysql"
              }
            },
            "spec": {
              "container": [
                {
                  "env": [
                    {
                      "name": "MYSQL_ROOT_PASSWORD",
                      "value": "${var.dbPassword}"
                    }
                  ],
                  "image": "mysql:latest",
                  "name": "mysql",
                  "port": [
                    {
                      "container_port": 3306
                    }
                  ],
                  "volume_mount": [
                    {
                      "mount_path": "/var/lib/mysql",
                      "name": "mysql-data"
                    }
                  ]
                }
              ],
              "volume": [
                {
                  "name": "mysql-data",
                  "persistent_volume_claim": {
                    "claim_name": "mysql-pv-claim"
                  }
                }
              ]
            }
          }
        }
      },
      "trading-assistant": {
        "//": {
          "metadata": {
            "path": "trading-assistant-stateless/trading-assistant",
            "uniqueId": "trading-assistant"
          }
        },
        "metadata": {
          "labels": {
            "app": "trading-assistant"
          },
          "name": "trading-assistant",
          "namespace": "trading-assistant"
        },
        "spec": {
          "replicas": "1",
          "selector": {
            "match_labels": {
              "app": "trading-assistant"
            }
          },
          "template": {
            "metadata": {
              "labels": {
                "app": "trading-assistant"
              }
            },
            "spec": {
              "container": [
                {
                  "env": [
                    {
                      "name": "SPRING_PROFILE",
                      "value": "currencies"
                    },
                    {
                      "name": "DATABASE_URL",
                      "value": "jdbc:mysql://mysql-service:3306/metatrader"
                    },
                    {
                      "name": "DATABASE_PASSWORD",
                      "value": "${var.dbPassword}"
                    },
                    {
                      "name": "SLACK_WEBHOOK_URL",
                      "value": "${var.slackWebHook}"
                    },
                    {
                      "name": "SUMO_LOGIC_WEBHOOK_URL",
                      "value": "${var.sumoLogicWebHook}"
                    }
                  ],
                  "image": "ghcr.io/willhumphreys/trading-assistant:backend-latest",
                  "image_pull_policy": "Always",
                  "name": "trading-assistant",
                  "port": [
                    {
                      "container_port": 8080
                    }
                  ],
                  "volume_mount": [
                    {
                      "mount_path": "/accounts",
                      "name": "accounts-volume"
                    },
                    {
                      "mount_path": "/mochi-graphs",
                      "name": "mochi-graphs-volume"
                    },
                    {
                      "mount_path": "/mt",
                      "name": "mt-volume"
                    }
                  ]
                }
              ],
              "volume": [
                {
                  "host_path": {
                    "path": "/home/will/accounts"
                  },
                  "name": "accounts-volume"
                },
                {
                  "host_path": {
                    "path": "/home/will/mochi-graphs"
                  },
                  "name": "mochi-graphs-volume"
                },
                {
                  "host_path": {
                    "path": "/home/will/.cxoffice/MetaTrader_5/drive_c/Program Files/MetaTrader 5/MQL5/Files"
                  },
                  "name": "mt-volume"
                }
              ]
            }
          }
        }
      },
      "trading-assistant-frontend": {
        "//": {
          "metadata": {
            "path": "trading-assistant-stateless/trading-assistant-frontend",
            "uniqueId": "trading-assistant-frontend"
          }
        },
        "metadata": {
          "labels": {
            "app": "trading-assistant-frontend"
          },
          "name": "trading-assistant-frontend",
          "namespace": "trading-assistant"
        },
        "spec": {
          "replicas": "1",
          "selector": {
            "match_labels": {
              "app": "trading-assistant-frontend"
            }
          },
          "template": {
            "metadata": {
              "labels": {
                "app": "trading-assistant-frontend"
              }
            },
            "spec": {
              "container": [
                {
                  "image": "ghcr.io/willhumphreys/trading-assistant:frontend-latest",
                  "image_pull_policy": "Always",
                  "name": "trading-assistant",
                  "port": [
                    {
                      "container_port": 3000
                    }
                  ]
                }
              ]
            }
          }
        }
      }
    },
    "kubernetes_service": {
      "mysql-service": {
        "//": {
          "metadata": {
            "path": "trading-assistant-stateless/mysql-service",
            "uniqueId": "mysql-service"
          }
        },
        "lifecycle": {
          "ignore_changes": [
            "metadata[0].annotations[\"metallb.universe.tf/ip-allocated-from-pool\"]"
          ]
        },
        "metadata": {
          "labels": {
            "app": "mysql"
          },
          "name": "mysql-service",
          "namespace": "trading-assistant"
        },
        "spec": {
          "port": [
            {
              "port": 3306,
              "target_port": "3306"
            }
          ],
          "selector": {
            "app": "mysql"
          },
          "type": "LoadBalancer"
        }
      },
      "trading-assistant-frontend-service": {
        "//": {
          "metadata": {
            "path": "trading-assistant-stateless/trading-assistant-frontend-service",
            "uniqueId": "trading-assistant-frontend-service"
          }
        },
        "lifecycle": {
          "ignore_changes": [
            "metadata[0].annotations[\"metallb.universe.tf/ip-allocated-from-pool\"]"
          ]
        },
        "metadata": {
          "annotations": {
            "service.beta.kubernetes.io/aws-load-balancer-proxy-protocol": "*"
          },
          "labels": {
            "app": "trading-assistant-frontend"
          },
          "name": "trading-assistant-frontend-service",
          "namespace": "trading-assistant"
        },
        "spec": {
          "port": [
            {
              "name": "http",
              "port": 80,
              "target_port": "3000"
            }
          ],
          "selector": {
            "app": "trading-assistant-frontend"
          },
          "type": "LoadBalancer"
        }
      },
      "trading-assistant-service": {
        "//": {
          "metadata": {
            "path": "trading-assistant-stateless/trading-assistant-service",
            "uniqueId": "trading-assistant-service"
          }
        },
        "lifecycle": {
          "ignore_changes": [
            "metadata[0].annotations[\"metallb.universe.tf/ip-allocated-from-pool\"]"
          ]
        },
        "metadata": {
          "annotations": {
            "service.beta.kubernetes.io/aws-load-balancer-proxy-protocol": "*"
          },
          "labels": {
            "app": "trading-assistant"
          },
          "name": "trading-assistant-service",
          "namespace": "trading-assistant"
        },
        "spec": {
          "port": [
            {
              "port": 8080,
              "target_port": "8080"
            }
          ],
          "selector": {
            "app": "trading-assistant"
          },
          "type": "LoadBalancer"
        }
      }
    }
  },
  "terraform": {
    "backend": {
      "local": {
        "path": "/home/runner/work/darwinex-client/darwinex-client/kube-infrastructure/terraform.trading-assistant-stateless.tfstate"
      }
    },
    "required_providers": {
      "kubernetes": {
        "source": "kubernetes",
        "version": "2.24.0"
      }
    }
  },
  "variable": {
    "dbPassword": {
      "description": "root password for mysql",
      "sensitive": true,
      "type": "string"
    },
    "slackWebHook": {
      "description": "slack webhook url",
      "sensitive": true,
      "type": "string"
    },
    "sumoLogicWebHook": {
      "description": "sumo logic webhook url",
      "sensitive": true,
      "type": "string"
    }
  }
}